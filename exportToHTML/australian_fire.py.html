<html>
<head>
<title>australian_fire.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #808080;}
.s3 { color: #6897bb;}
.s4 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
australian_fire.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">numpy</span>
<span class="s0">import </span><span class="s1">pandas </span><span class="s0">as </span><span class="s1">pd</span>
<span class="s0">import </span><span class="s1">numpy </span><span class="s0">as </span><span class="s1">np</span>
<span class="s0">import </span><span class="s1">tensorflow </span><span class="s0">as </span><span class="s1">tf</span>
<span class="s0">from </span><span class="s1">tensorflow.keras </span><span class="s0">import </span><span class="s1">layers</span>
<span class="s0">from </span><span class="s1">tensorflow.keras.layers.experimental </span><span class="s0">import </span><span class="s1">preprocessing</span>
<span class="s0">from </span><span class="s1">sklearn.model_selection </span><span class="s0">import </span><span class="s1">train_test_split</span>
<span class="s0">from </span><span class="s1">sklearn.preprocessing </span><span class="s0">import </span><span class="s1">LabelEncoder</span>

<span class="s2"># making numpy values easy to read</span>

<span class="s1">np.set_printoptions(precision=</span><span class="s3">3</span><span class="s0">, </span><span class="s1">suppress=</span><span class="s0">True</span><span class="s1">)</span>

<span class="s2"># Data loading with pandas</span>

<span class="s1">australian_fire_dataset = pd.read_csv(</span><span class="s4">&quot;australian_fire.csv&quot;</span><span class="s1">)</span>

<span class="s2"># separating features and labels for training  x = feature = independent variable    y =  label = dependent variable</span>
<span class="s2"># WE EXTRACTING DEPENDENT(LABEL) AND INDEPENDENT(FEATURE) VARIABLES.</span>

<span class="s1">x = australian_fire_dataset.copy()</span>
<span class="s1">x = np.array(x)   </span><span class="s2"># load it on the numpy array</span>
<span class="s1">x = np.delete(x</span><span class="s0">, </span><span class="s1">numpy.s_[</span><span class="s3">5</span><span class="s1">:</span><span class="s3">7</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s1">) </span><span class="s2"># we delete acq_date and time which is unnecessary features for our training models. Their numeric values means nothing for us.</span>
<span class="s1">x = np.delete(x</span><span class="s0">, </span><span class="s1">numpy.s_[</span><span class="s3">6</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s1">) </span><span class="s2"># we delete instrument column Which is only 1 unique value MODİS since all of them are the same</span>
<span class="s1">x = np.delete(x</span><span class="s0">, </span><span class="s1">numpy.s_[</span><span class="s3">6</span><span class="s1">:</span><span class="s3">8</span><span class="s1">]</span><span class="s0">, </span><span class="s3">1</span><span class="s1">) </span><span class="s2"># we delete version which is all of the same and doesnt affect &quot;6.0NRT&quot; and also we delete the CONFİDENCE LABEL in our features.</span>

<span class="s2"># ENCODING CATEGORICAL DATAS  ( DAYNIGHT AND SATELLITE ) 5. ve 8 th indexes.</span>
<span class="s1">label_encoder= LabelEncoder()</span>
<span class="s1">x[:</span><span class="s0">, </span><span class="s3">5</span><span class="s1">]= label_encoder.fit_transform(x[:</span><span class="s0">, </span><span class="s3">5</span><span class="s1">])  </span><span class="s2"># we encoding the Satellite values to TERRA  = 1  and AQUA = 0</span>
<span class="s1">x[:</span><span class="s0">, </span><span class="s3">8</span><span class="s1">]= label_encoder.fit_transform(x[:</span><span class="s0">, </span><span class="s3">8</span><span class="s1">])  </span><span class="s2"># we encoding the Daynight values to Day = 0 and Night = 1</span>


<span class="s2"># To extract an independent variable, we will use iloc[ ] method of Pandas library.</span>
<span class="s2"># It is used to extract the required rows and columns from the dataset.</span>

<span class="s1">y = australian_fire_dataset.iloc[:</span><span class="s0">, </span><span class="s3">9</span><span class="s1">].values   </span><span class="s2"># we only take the confidence column</span>

<span class="s2"># We convert it because i got the error which is &quot;failed to convert a numpy array to tensor object&quot; so i convert the float32 type and array</span>
<span class="s1">x = np.asarray(x).astype(</span><span class="s4">'float32'</span><span class="s1">)</span>

<span class="s2"># It is just basic preprocessing for normalization inputs for CSV data files.</span>
<span class="s1">normalize = preprocessing.Normalization()</span>
<span class="s1">normalize.adapt(x)</span>

<span class="s2"># SPLITTING TRAINING AND TEST DATASET</span>
<span class="s1">x_train</span><span class="s0">, </span><span class="s1">x_test</span><span class="s0">, </span><span class="s1">y_train</span><span class="s0">, </span><span class="s1">y_test = train_test_split(x</span><span class="s0">, </span><span class="s1">y</span><span class="s0">, </span><span class="s1">test_size= </span><span class="s3">0.2</span><span class="s0">, </span><span class="s1">random_state=</span><span class="s3">0</span><span class="s1">)</span>

<span class="s2"># Since we need an one input for each column I choose the keras.sequential model</span>

<span class="s1">Australian_fire_Model = tf.keras.Sequential([   </span><span class="s2"># Sequential model gets one input and one  output (and sequantial model is also called the &quot;list of layers&quot;.</span>
    <span class="s1">normalize</span><span class="s0">,</span>
    <span class="s1">layers.Dense(</span><span class="s3">256</span><span class="s0">,</span><span class="s1">activation=</span><span class="s4">&quot;relu&quot;</span><span class="s0">,</span><span class="s1">name=</span><span class="s4">&quot;layer1&quot;</span><span class="s1">)</span><span class="s0">,     </span><span class="s2"># LAYERS  converts input to  output . Model  looks like a big layer.</span>
    <span class="s1">layers.Dense(</span><span class="s3">192</span><span class="s0">,</span><span class="s1">activation=</span><span class="s4">&quot;relu&quot;</span><span class="s0">,</span><span class="s1">name=</span><span class="s4">&quot;layer2&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">layers.Dense(</span><span class="s3">128</span><span class="s0">,</span><span class="s1">activation=</span><span class="s4">&quot;relu&quot;</span><span class="s0">,</span><span class="s1">name=</span><span class="s4">&quot;layer3&quot;</span><span class="s1">)</span><span class="s0">,</span>
    <span class="s1">layers.Dense(</span><span class="s3">100</span><span class="s0">,</span><span class="s1">activation=</span><span class="s4">&quot;relu&quot;</span><span class="s0">, </span><span class="s1">name=</span><span class="s4">&quot;layer4&quot;</span><span class="s1">)  </span><span class="s2"># OUTPUT LAYER WE HAVE 100 OUTPUTS  Ratings from 0-100.</span>
    <span class="s2"># RELU IS DEFAULT TO GO. BUT WE CAN GO TO PROBABILITY DISTRIBUTION WITH SOFTMAX BUT THAT IS NOT OUR CASE</span>
<span class="s1">])</span>
<span class="s1">Australian_fire_Model.compile(loss=tf.losses.MeanSquaredError()</span><span class="s0">,</span>
                              <span class="s1">optimizer=tf.optimizers.Adam())</span>

<span class="s2"># for train a model</span>
<span class="s1">Australian_fire_Model.fit(x_train</span><span class="s0">, </span><span class="s1">y_train</span><span class="s0">, </span><span class="s1">epochs=</span><span class="s3">100</span><span class="s1">)    </span><span class="s2"># BATCH SIZE = NUMBER OF THE ROWS (HOW MANY ROWS WILL BE RETURNED AT ONCE)</span>
</pre>
</body>
</html>